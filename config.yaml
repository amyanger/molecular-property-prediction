# Molecular Property Prediction - Configuration
# Centralized hyperparameters for all models and training

# =============================================================================
# Dataset Configuration
# =============================================================================
data:
  dataset: "tox21"
  test_size: 0.2
  val_size: 0.125  # 0.125 * 0.8 = 0.1 of total
  random_state: 42
  num_tasks: 12

# =============================================================================
# Common Training Settings
# =============================================================================
training:
  batch_size: 64
  learning_rate: 0.001
  weight_decay: 0.01
  epochs: 100
  early_stopping_patience: 10
  gradient_clip_norm: 1.0
  scheduler: "cosine_annealing"
  optimizer: "adamw"

# =============================================================================
# MLP Model Configuration
# =============================================================================
mlp:
  fingerprint_size: 2048
  fingerprint_radius: 2
  hidden_sizes: [1024, 512, 256]
  dropout: 0.4
  epochs: 50  # Override common setting

# =============================================================================
# GNN (GCN) Model Configuration
# =============================================================================
gnn:
  hidden_channels: 256
  num_layers: 4
  dropout: 0.2
  conv_type: "gcn"  # Options: gcn, gat
  epochs: 50  # Override common setting
  # Pre-training options
  pretrained: false
  freeze_encoder: false

# =============================================================================
# AttentiveFP Model Configuration
# =============================================================================
attentivefp:
  hidden_channels: 256
  num_layers: 3
  num_timesteps: 3
  dropout: 0.2
  early_stopping_patience: 15  # Override common setting
  epochs: 100

# =============================================================================
# Ensemble Configuration
# =============================================================================
ensemble:
  weights:
    mlp: 0.1
    gcn: 0.5
    attentivefp: 0.4
  # Grid search ranges for weight optimization
  weight_search:
    min: 0.1
    max: 0.8
    step: 0.1

# =============================================================================
# Feature Extraction
# =============================================================================
features:
  # Morgan Fingerprints (MLP)
  morgan:
    radius: 2
    n_bits: 2048

  # GCN Node Features (141 dimensions)
  gcn_node:
    atomic_num_values: 118
    degree_values: 6      # 0-5
    charge_values: 5      # -2 to +2
    hybridization_values: 5
    num_h_values: 5       # 0-4
    include_aromaticity: true
    include_in_ring: true

  # AttentiveFP Node Features (148 dimensions)
  attentivefp_node:
    atomic_num_values: 118
    degree_values: 7      # 0-6
    charge_values: 7      # -3 to +3
    hybridization_values: 5
    num_h_values: 5
    include_aromaticity: true
    include_in_ring: true
    include_chiral_tag: true

  # AttentiveFP Edge Features (12 dimensions)
  attentivefp_edge:
    bond_type_values: 4   # single, double, triple, aromatic
    stereo_values: 6
    include_conjugated: true
    include_in_ring: true

# =============================================================================
# Paths (relative to project root)
# =============================================================================
paths:
  data_dir: "data"
  models_dir: "models"
  results_dir: "models"

# =============================================================================
# Model Checkpoints
# =============================================================================
checkpoints:
  mlp: "best_model.pt"
  gnn: "best_gnn_model.pt"
  attentivefp: "best_attentivefp_model.pt"
  pretrained_gnn: "pretrained_gnn_encoder.pt"

# =============================================================================
# Results Files
# =============================================================================
results:
  mlp: "results.json"
  gnn: "gnn_results.json"
  attentivefp: "attentivefp_results.json"
  ensemble: "ensemble_results.json"

# =============================================================================
# Logging (for future implementation)
# =============================================================================
logging:
  level: "INFO"
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  save_to_file: false
  log_file: "training.log"

# =============================================================================
# Device Configuration
# =============================================================================
device:
  prefer_gpu: true
  gpu_id: 0
  # For RTX 5090 (Blackwell sm_120), requires PyTorch nightly
  # Install: pip install --pre torch --index-url https://download.pytorch.org/whl/nightly/cu128
